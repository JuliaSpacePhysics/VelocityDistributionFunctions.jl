var documenterSearchIndex = {"docs":
[{"location":"distributions/#Velocity-Distribution-Functions","page":"Distributions","title":"Velocity Distribution Functions","text":"This package provides implementations of common velocity distribution functions used in plasma physics.\n\nFor Kappa distribution, see Kappa.","category":"section"},{"location":"distributions/#Maxwellian-Distribution","page":"Distributions","title":"Maxwellian Distribution","text":"The isotropic Maxwellian distribution is the most basic equilibrium distribution:\n\nusing VelocityDistributionFunctions\n\nv_th = 1.0 # Thermal velocity\nu0 = [0.5, 0.0, 0.0] # Drift velocity\nvdf = Maxwellian(v_th; u0)\n\n# Sample from the distribution\nsamples = rand(vdf, 10000)\n\n# Evaluate Theoretical PDF\nð¯ = [1.0, 0.0, 0.0]\nvdf(ð¯)\n\nUnit is also supported\n\nusing Unitful\n\nT = 30000u\"K\" # Temperature\nvdf = Maxwellian(T)\n\nð¯ = ones(3) .* 1u\"m/s\"\n@assert vdf(ð¯) â‰ˆ 2.070889302986066e-19 * 1u\"s^3/m^3\"\n\n# If the density is given, it will return a VelocityDistribution instead of a PDF\nn = 1u\"m^-3\"\np = n * Unitful.k * T\nvdf = Maxwellian(n, p)\nvdf(ð¯)\n\nStrip units from a distribution using ustrip.\n\nvdf_unitless = ustrip(vdf)\nvdf_unitless(ustrip(ð¯))","category":"section"},{"location":"distributions/#Visualization","page":"Distributions","title":"Visualization","text":"The following examples demonstrate sampling from distributions and comparing with theoretical PDFs using Makie.\n\nusing CairoMakie\nusing LinearAlgebra: norm\nusing VelocityDistributionFunctions: V\n\n# Create Maxwellian distribution\nvdf = Maxwellian(1.0)\n\n# Generate samples\nn_samples = 100000\nvs = rand(vdf, n_samples)\nspeeds = norm.(vs)\n\n# Theoretical speed distribution: f(v) = 4Ï€ vÂ² fâ‚ƒD(v)\n# where fâ‚ƒD is the 3D Maxwellian\nv_range = range(0, 4, length=200)\nspeed_pdf = vdf.(V.(v_range)) # using V constructor to denote speed\n\n# Plot\nlet fig = Figure()\n    ax = Axis(fig[1, 1],\n        xlabel=\"Speed\",\n        ylabel=\"Probability Density\",\n        title=\"Maxwellian Speed Distribution\")\n\n    hist!(ax, speeds, bins=100, normalization=:pdf, label=\"Samples\")\n    lines!(ax, v_range, speed_pdf, color=:red, linewidth=2, label=\"Theory\")\n    axislegend(ax, position=:rt)\n    fig\nend","category":"section"},{"location":"distributions/#BiMaxwellian-Distribution","page":"Distributions","title":"BiMaxwellian Distribution","text":"The BiMaxwellian distribution has different thermal velocities parallel and perpendicular to a magnetic field:\n\nvdf = BiMaxwellian(0.5, 2.0)\n\nvs = rand(vdf, 10000)\nv_pars = getindex.(vs, 3)\nv_perps = [sqrt(v[1]^2 + v[2]^2) for v in vs]\n\nv_range = range(-4, 4, length=200)\nv_par_pdf = vdf.(VPar.(v_range))\nv_perp_range = range(0, 4, length=200)\nv_perp_pdf = vdf.(VPerp.(v_perp_range))\n\nlet fig = Figure()\n    ax = Axis(fig[1, 1], xlabel=L\"v_\\parallel\", ylabel=\"Probability Density\", title=\"Bi-Maxwellian Parallel\")\n\n    hist!(ax, v_pars, bins=100, normalization=:pdf, label=\"Samples\")\n    lines!(ax, v_range, v_par_pdf, color=:red, linewidth=2, label=\"Theory\")\n\n    ax2 = Axis(fig[1, 2], xlabel=L\"|\\mathbf{v}_\\perp|\", title=\"Bi-Maxwellian Perpendicular\")\n    hist!(ax2, v_perps, bins=100, normalization=:pdf, label=\"Samples\")\n    lines!(ax2, v_perp_range, v_perp_pdf, color=:red, linewidth=2, label=\"Theory\")\n    axislegend(ax2, position=:rt)\n    fig\nend","category":"section"},{"location":"distributions/#ShiftedPDF","page":"Distributions","title":"ShiftedPDF","text":"Any velocity PDF can be drifted by wrapping it in ShiftedPDF.\n\nbase = MaxwellianPDF(v_th)\nu0 = [0.5, 0.0, 0.0] \nvdf = ShiftedPDF(base, u0)","category":"section"},{"location":"distributions/#VelocityDistributionFunctions.Maxwellian-distributions","page":"Distributions","title":"VelocityDistributionFunctions.Maxwellian","text":"Maxwellian(args...; u0=nothing, kw...)\nMaxwellian(n, args...; u0=nothing, kw...)\n\nConstruct a MaxwellianPDF velocity distribution.\n\nIf n is provided, returns VelocityDistribution with n and the distribution MaxwellianPDF(args...; kw...). If u0 is provided, returns ShiftedPDF with the distribution MaxwellianPDF(args...; kw...) and u0.\n\n\n\n\n\n","category":"function"},{"location":"distributions/#VelocityDistributionFunctions.BiMaxwellian-distributions","page":"Distributions","title":"VelocityDistributionFunctions.BiMaxwellian","text":"BiMaxwellian(args...; u0=nothing, kw...)\nBiMaxwellian(n, args...; u0=nothing, kw...)\n\nConstruct a BiMaxwellianPDF velocity distribution.\n\nIf n is provided, returns VelocityDistribution with n and the distribution BiMaxwellianPDF(args...; kw...). If u0 is provided, returns ShiftedPDF with the distribution BiMaxwellianPDF(args...; kw...) and u0.\n\n\n\n\n\n","category":"function"},{"location":"kappa/#Kappa-Distribution","page":"Kappa","title":"Kappa Distribution","text":"The Kappa distribution has power-law tails and is commonly observed in space plasmas.\n\nusing VelocityDistributionFunctions\nimport VelocityDistributionFunctions as VDFs\nusing VelocityDistributionFunctions: V\nusing Random, Unitful, LinearAlgebra\nusing CairoMakie\n\n# Create Kappa distribution: vth=1.0, Îº=3.0\nvdf = Kappa(1.0, 3.0)\n\n# Create Kappa distribution with temperature\nT = 30000u\"K\"\nvdf2 = Kappa(T, 4.0)\nð¯ = ones(3) .* 1u\"m/s\"\n# Get the PDF value at ð¯\nvdf2(ð¯)","category":"section"},{"location":"kappa/#Example:-BiKappa-(anisotropic-kappa)","page":"Kappa","title":"Example: BiKappa (anisotropic kappa)","text":"# Create an anisotropic kappa distribution (different perpendicular/parallel thermal speeds)\nÎº = 3.0\n# Unitful constructor using temperatures (perp/para)\nTperp = 30000u\"K\"\nTpara = 60000u\"K\"\nvdf_bi = BiKappa(Tperp, Tpara, Îº)\nvdf_bi(ones(3) .* 1u\"m/s\")","category":"section"},{"location":"kappa/#Example:-Compare-1D-projection-PDF-with-theory","page":"Kappa","title":"Example: Compare 1D projection PDF with theory","text":"Random.seed!(123)\nvs = rand(vdf, 10000)\nvxs = getindex.(vs, 1)\nv_range = range(-8, 8, length=200)\nvx_pdf = VDFs._pdf_1d.(vdf, v_range)\n\nlet fig = Figure()\n    ax = Axis(fig[1, 1], title = \"Kappa (kappa=3)\", xlabel = \"vx\", ylabel = \"PDF\", yscale = log10)\n    hist!(ax, vxs, normalization = :pdf, bins = 48, label = \"Sampled\")\n    lines!(ax, v_range, vx_pdf, label = \"Theory\", color = :red, linewidth = 2)\n    axislegend(ax)\n    ylims!(ax, 3e-4, nothing)\n    fig\nend","category":"section"},{"location":"kappa/#Example:-Sampling-Kappa-Heavy-Tails","page":"Kappa","title":"Example: Sampling Kappa Heavy Tails","text":"Here we compare the sampling of different kappa distributions with the same temperature (the second moment of the distribution).\n\nkappas = [2.5, 5.0, 10.0, 20]\ncolors = [:orange, :green, :blue, :red, ]\n\nfig = Figure(size=(800, 600))\nax = Axis(fig[1, 1],\n    xlabel=\"Speed [m/s]\",\n    ylabel=\"Probability Density\",\n    title=\"Kappa Distribution: Effect of Îº parameter\",\n    yscale=log10)\n\nvmax = 6e6\nv_range = range(0, vmax, length=200)\n\nRandom.seed!(123)\nT = 30000u\"K\"\nfor (Îº, color) in zip(kappas, colors)\n    vdf = ustrip(Kappa(T, Îº))\n    n_samples = 100000\n    samples = rand(vdf, n_samples)\n    speeds = norm.(samples)\n\n    # Theoretical PDF\n    speed_pdf = vdf.(V.(v_range))\n\n    # Plot\n    hist!(ax, speeds, bins=200, normalization=:pdf,\n          color=(color, 0.3), label=\"Îº=$Îº (samples)\")\n    lines!(ax, v_range, speed_pdf, color=color, linewidth=2,\n           label=\"Îº=$Îº (theory)\", linestyle=:dash)\nend\n\naxislegend(ax, position=:rt)\nxlims!(ax, 0, vmax)\nylims!(ax, 1e-9, nothing)\nfig","category":"section"},{"location":"kappa/#Example:-Comparing-Maxwellian-and-Kappa-Distributions","page":"Kappa","title":"Example: Comparing Maxwellian and Kappa Distributions","text":"d_max = Maxwellian(1.0)\nÎº = 3.0\nd_kappa = Kappa(1.0, Îº)\n\nn_samples = 50000\nsamples_max = rand(d_max, n_samples)\nsamples_kappa = rand(d_kappa, n_samples)\n\nspeeds_max = norm.(samples_max)\nspeeds_kappa = norm.(samples_kappa)\n\n# Theoretical distributions\nv_range = range(0, 5, length=200)\nspeed_pdf_max = d_max.(V.(v_range))\nspeed_pdf_kappa = d_kappa.(V.(v_range))\n\n# Plot\nlet fig = Figure(size=(800, 600))\n    ax = Axis(fig[1, 1], xlabel=\"Speed\", ylabel=\"Probability Density\", title=\"Maxwellian vs Kappa Distribution (Îº=$Îº)\", yscale=log10)\n    hist!(ax, speeds_max, bins=100, normalization=:pdf, label=\"Maxwellian (samples)\", alpha=0.5)\n    hist!(ax, speeds_kappa, bins=100, normalization=:pdf, label=\"Kappa (samples)\", alpha=0.5)\n    lines!(ax, v_range, speed_pdf_max, color=:blue, linewidth=2, label=\"Maxwellian (theory)\", linestyle=:dash)\n    lines!(ax, v_range, speed_pdf_kappa, color=:red, linewidth=2, label=\"Kappa (theory)\", linestyle=:dash)\n    axislegend(ax, position=:rt)\n    ylims!(ax, 1e-4, nothing)\n    fig\nend","category":"section"},{"location":"kappa/#Math-notes","page":"Kappa","title":"Math notes","text":"","category":"section"},{"location":"kappa/#The-Theoretical-1D-PDF","page":"Kappa","title":"The Theoretical 1D PDF","text":"The 1D projection of the given 3D Kappa distribution is:\n\nf_1D(v_x) = fracGamma(kappa)sqrtpi kappa v_th Gamma(kappa - 12) left(1 + frac(v_x - u_0x)^2kappa v_th^2right)^-kappa\n\nNotes that the power changes from -(kappa + 1) in 3D to -kappa in 1D.","category":"section"},{"location":"kappa/#Mathematical-Derivation","page":"Kappa","title":"Mathematical Derivation","text":"To find the 1D PDF f(v_x), we must integrate out the other velocity components (v_y and v_z). Let mathbfv - mathbfu_0 = (u_x u_y u_z). We integrate over u_y and u_z:\n\nf(v_x) = iint_-infty^infty A_3 left(1 + fracu_x^2 + u_y^2 + u_z^2kappa v_th^2right)^-(kappa + 1) du_y  du_z\n\nAfter grouping the x terms into a constant C (relative to the integration variables u_y u_z): C = 1 + fracu_x^2kappa v_th^2\n\nThe integrand becomes: left(C + fracu_y^2 + u_z^2kappa v_th^2right)^-(kappa + 1) = C^-(kappa+1) left(1 + fracu_y^2 + u_z^2C kappa v_th^2right)^-(kappa + 1)\n\n1. Perform the Integration\n\nWe convert the u_y u_z plane to polar coordinates (r theta) where r^2 = u_y^2 + u_z^2. The area element is 2pi r dr. Let a^2 = C kappa v_th^2.\n\nI = int_0^infty left(1 + fracr^2a^2right)^-(kappa + 1) 2pi r  dr\n\nUsing the substitution w = 1 + fracr^2a^2, we get dw = frac2ra^2 dr implies 2r dr = a^2 dw.\n\nI = pi a^2 int_1^infty w^-(kappa + 1)  dw = pi a^2 left fracw^-kappa-kappa right_1^infty = fracpi a^2kappa\n\nSubstitute a^2 = C kappa v_th^2 back:\n\nI = fracpi (C kappa v_th^2)kappa = pi v_th^2 C\n\n3. Combine and Simplify Constants\n\nNow substitute the integral result I and the constant term C^-(kappa+1) back into the expression for f(v_x):\n\nf(v_x) = A_3 cdot C^-(kappa+1) cdot I = A_3 pi v_th^2 C^-kappa\n\nNow expand A_3 and simplify:\n\nf(v_x) = left fracGamma(kappa + 1)(pi kappa v_th^2)^32 Gamma(kappa - 12) right pi v_th^2 left(1 + fracu_x^2kappa v_th^2right)^-kappa\n\nIsolate the constants:\n\ntextCoeff = fracGamma(kappa + 1) pi v_th^2pi^32 kappa^32 v_th^3 Gamma(kappa - 12) = fracGamma(kappa + 1)sqrtpi kappa^32 v_th Gamma(kappa - 12)\n\nUsing the property Gamma(kappa + 1) = kappa Gamma(kappa), we cancel one kappa:\n\ntextCoeff = frackappa Gamma(kappa)sqrtpi kappa sqrtkappa v_th Gamma(kappa - 12) = fracGamma(kappa)sqrtpi kappa v_th Gamma(kappa - 12)\n\nThis yields the final result.","category":"section"},{"location":"kappa/#VelocityDistributionFunctions.KappaDistribution-kappa","page":"Kappa","title":"VelocityDistributionFunctions.KappaDistribution","text":"A Kappa distribution has a nearly Maxwellian core at low energies, and highenergy tails decreasing as suprathermal power laws that can be significantly broader than exponential tails.\n\nSee also Pierrard et al. [1] and Pierrard and Lazar [2].\n\n\n\n\n\n","category":"type"},{"location":"kappa/#VelocityDistributionFunctions.BiKappaPDF-kappa","page":"Kappa","title":"VelocityDistributionFunctions.BiKappaPDF","text":"BiKappaPDF(vth_perp, vth_para, Îº, b0=[0, 0, 1])\nBiKappaPDF(T_perp::Temperature, T_para::Temperature, Îº, b0=[0, 0, 1]; mass = me)\n\nModified BiKappa velocity distribution with kappa index Îº, assuming Îº-independent temperatures T_, with magnetic field direction b0. \n\nThe distribution can also be parameterized by kappa thermal speeds v_th and v_th.\n\nbeginaligned\nf_Îº(ð¯)   left1 + fracv_^2Îº v_mathrmth ^2 + fracv_^2Îº v_mathrmth ^2right^- Îº - 1 \n     = left1+fracmk_B (2 Îº-3) left(fracv_^2T_+fracv_^2T_right) right^-Îº-1\nendaligned\n\nwhere the normalization constant is\n\nbeginaligned\nA_Îº = left(frac1Ï€ Îºright)^32 frac1v_th v_th^2 fracÎ“Îº+1Î“Îº-12 \n  = leftfracmÏ€ k_B(2 Îº-3)right^3  2 frac1T_ sqrtT_ fracÎ“Îº+1Î“Îº-12\nendaligned\n\nSee also Kappa, kappa_thermal_speed\n\n\n\n\n\n","category":"type"},{"location":"#VelocityDistributionFunctions","page":"Home","title":"VelocityDistributionFunctions","text":"Documentation for VelocityDistributionFunctions.\n\n\n\nV.Â Pierrard, M.Â Lazar and M.Â Maksimovic. Suprathermal Populations and Their Effects in Space Plasmas: Kappa vs. Maxwellian. In: Kappa Distributions: From Observational Evidences Via Controversial Predictions to a Consistent Theory of Nonequilibrium Plasmas, edited by M.Â Lazar and H.Â Fichtner (Springer International Publishing, Cham, 2021); pp.Â 15â€“38.\n\n\n\nV.Â Pierrard and M.Â Lazar. Kappa Distributions: Theory and Applications in Space Plasmas. SolarÂ Physics 267, 153â€“174 (2010).\n\n\n\n","category":"section"},{"location":"#VelocityDistributionFunctions.AbstractVelocityDistribution","page":"Home","title":"VelocityDistributionFunctions.AbstractVelocityDistribution","text":"Abstract type for velocity distributions.\n\n\n\n\n\n","category":"type"},{"location":"#VelocityDistributionFunctions.AbstractVelocityPDF","page":"Home","title":"VelocityDistributionFunctions.AbstractVelocityPDF","text":"Abstract type for velocity probability distribution functions, extending MultivariateDistribution.\n\n\n\n\n\n","category":"type"},{"location":"#VelocityDistributionFunctions.BiKappaPDF","page":"Home","title":"VelocityDistributionFunctions.BiKappaPDF","text":"BiKappaPDF(vth_perp, vth_para, Îº, b0=[0, 0, 1])\nBiKappaPDF(T_perp::Temperature, T_para::Temperature, Îº, b0=[0, 0, 1]; mass = me)\n\nModified BiKappa velocity distribution with kappa index Îº, assuming Îº-independent temperatures T_, with magnetic field direction b0. \n\nThe distribution can also be parameterized by kappa thermal speeds v_th and v_th.\n\nbeginaligned\nf_Îº(ð¯)   left1 + fracv_^2Îº v_mathrmth ^2 + fracv_^2Îº v_mathrmth ^2right^- Îº - 1 \n     = left1+fracmk_B (2 Îº-3) left(fracv_^2T_+fracv_^2T_right) right^-Îº-1\nendaligned\n\nwhere the normalization constant is\n\nbeginaligned\nA_Îº = left(frac1Ï€ Îºright)^32 frac1v_th v_th^2 fracÎ“Îº+1Î“Îº-12 \n  = leftfracmÏ€ k_B(2 Îº-3)right^3  2 frac1T_ sqrtT_ fracÎ“Îº+1Î“Îº-12\nendaligned\n\nSee also Kappa, kappa_thermal_speed\n\n\n\n\n\n","category":"type"},{"location":"#VelocityDistributionFunctions.BiMaxwellianPDF","page":"Home","title":"VelocityDistributionFunctions.BiMaxwellianPDF","text":"BiMaxwellian(vth_perp, vth_para, b0=[0, 0, 1])\nBiMaxwellian(T_perp::Temperature, T_para::Temperature, b0=[0, 0, 1]; mass = me)\n\nBiMaxwellian velocity distribution with different thermal velocities in perpendicular vth_perp and parallel vth_para directions and magnetic field direction b0.\n\nf(ð¯)   exp-fracð¯_^2v_mathrmth ^2 exp-fracð¯_^2v_mathrmth ^2\n\nwhere the normalization constant is A = Ï€^-3  (v_th v_th^2).\n\n\n\n\n\n","category":"type"},{"location":"#VelocityDistributionFunctions.KappaDistribution","page":"Home","title":"VelocityDistributionFunctions.KappaDistribution","text":"A Kappa distribution has a nearly Maxwellian core at low energies, and highenergy tails decreasing as suprathermal power laws that can be significantly broader than exponential tails.\n\nSee also Pierrard et al. [1] and Pierrard and Lazar [2].\n\n\n\n\n\n","category":"type"},{"location":"#VelocityDistributionFunctions.KappaPDF","page":"Home","title":"VelocityDistributionFunctions.KappaPDF","text":"KappaPDF(vth, Îº)\nKappaPDF(T::Temperature, Îº; mass = me)\n\nKappa velocity distribution with index Îº and thermal velocity vth.\n\nf(ð¯)  1 + ð¯Â²(Îºvâ‚œâ‚•Â²)^-(Îº+1)\n\nwhere the normalization constant is A_3 = Î“(Îº + 1)  Î“(Îº - 12)  (Ï€ Îº v_th^2)^32.\n\nNotes\n\nKappa index must be > 1.5 for finite variance. For large Îº, the distribution approaches a Maxwellian. Smaller Îº values produce stronger high-energy tails.\n\nSee also kappa_thermal_speed.\n\n\n\n\n\n","category":"type"},{"location":"#VelocityDistributionFunctions.MaxwellianPDF","page":"Home","title":"VelocityDistributionFunctions.MaxwellianPDF","text":"Maxwellian(vth)\nMaxwellian(T::Temperature; mass = me)\n\nIsotropic Maxwellian velocity distribution with thermal velocity vth / temperature T.\n\n\n\n\n\n","category":"type"},{"location":"#VelocityDistributionFunctions.ShiftedPDF","page":"Home","title":"VelocityDistributionFunctions.ShiftedPDF","text":"ShiftedPDF(base, u0)\n\nVelocity distribution with a drift velocity u0 applied to a base distribution.\n\n\n\n\n\n","category":"type"},{"location":"#VelocityDistributionFunctions.VelocityDistribution","page":"Home","title":"VelocityDistributionFunctions.VelocityDistribution","text":"VelocityDistribution(n, pdf)\n\nPhysical velocity distribution combining number density n with a velocity probability distribution pdf.\n\n\n\n\n\n","category":"type"},{"location":"#Distributions.pdf-Tuple{BiMaxwellianPDF, VPar}","page":"Home","title":"Distributions.pdf","text":"Normalized PDF for the parallel velocity\n\nf(v) = 1  (Ï€ vâ‚œâ‚•)  exp-(vvâ‚œâ‚•)Â²\n\n\n\n\n\n","category":"method"},{"location":"#Unitful.ustrip-Tuple{T} where T<:Union{AbstractVelocityPDF, VelocityDistribution}","page":"Home","title":"Unitful.ustrip","text":"ustrip(d::VelocityDistribution)\n\nStrip units from all fields of a velocity distribution, returning a new distribution with unitless values.\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions.BiKappa-Tuple","page":"Home","title":"VelocityDistributionFunctions.BiKappa","text":"BiKappa(args...; u0=nothing, kw...)\nBiKappa(n, args...; u0=nothing, kw...)\n\nConstruct a BiKappaPDF velocity distribution.\n\nIf n is provided, returns VelocityDistribution with n and the distribution BiKappaPDF(args...; kw...). If u0 is provided, returns ShiftedPDF with the distribution BiKappaPDF(args...; kw...) and u0.\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions.BiMaxwellian-Tuple","page":"Home","title":"VelocityDistributionFunctions.BiMaxwellian","text":"BiMaxwellian(args...; u0=nothing, kw...)\nBiMaxwellian(n, args...; u0=nothing, kw...)\n\nConstruct a BiMaxwellianPDF velocity distribution.\n\nIf n is provided, returns VelocityDistribution with n and the distribution BiMaxwellianPDF(args...; kw...). If u0 is provided, returns ShiftedPDF with the distribution BiMaxwellianPDF(args...; kw...) and u0.\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions.Kappa-Tuple","page":"Home","title":"VelocityDistributionFunctions.Kappa","text":"Kappa(args...; u0=nothing, kw...)\nKappa(n, args...; u0=nothing, kw...)\n\nConstruct a KappaPDF velocity distribution.\n\nIf n is provided, returns VelocityDistribution with n and the distribution KappaPDF(args...; kw...). If u0 is provided, returns ShiftedPDF with the distribution KappaPDF(args...; kw...) and u0.\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions.Maxwellian-Tuple","page":"Home","title":"VelocityDistributionFunctions.Maxwellian","text":"Maxwellian(args...; u0=nothing, kw...)\nMaxwellian(n, args...; u0=nothing, kw...)\n\nConstruct a MaxwellianPDF velocity distribution.\n\nIf n is provided, returns VelocityDistribution with n and the distribution MaxwellianPDF(args...; kw...). If u0 is provided, returns ShiftedPDF with the distribution MaxwellianPDF(args...; kw...) and u0.\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions._rand!-Tuple{Random.AbstractRNG, KappaPDF, Any}","page":"Home","title":"VelocityDistributionFunctions._rand!","text":"_rand!(rng::AbstractRNG, d::Kappa, x)\n\nGenerates a random velocity vector sampled from the 3D Kappa distribution.\n\nAlgorithm: The Kappa distribution is generated using a compound probability method (decomposition  into a Maxwellian with a Chi-squared distributed temperature variance).\n\nSample from Chi-squared: Î¾ ~ ChiSq(2Îº - 1)\nSample from Isotropic Normal: Z ~ Normal(0, I)\nð¯ = vâ‚œâ‚• * (Îº  Î¾) * Z\n\nReferences\n\nhttps://www.wikiwand.com/en/articles/Student%27s_t-distribution\nMultivariate t-distribution\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions.directional_energy_spectra-Tuple{Any, Any, Any}","page":"Home","title":"VelocityDistributionFunctions.directional_energy_spectra","text":"directional_energy_spectra(spec_data, time_var, pitch_angles, loss_cone; para_tol=22.25, anti_tol=22.25)\n\nProcess 3D spectral data (pitchangle Ã— energy Ã— time) to extract directional flux spectra. This implements the same logic as pyspedas epdl2_Espectra function.\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions.kappa_thermal_speed-Tuple{Any, Any, Any}","page":"Home","title":"VelocityDistributionFunctions.kappa_thermal_speed","text":"kappa_thermal_speed(T, Îº, m)\n\nReturn the most probable speed of a (modified) kappa distribution with Îº-Independent temperature T.\n\nV_th = sqrtfracÎº - 32Îº frac2 k_B Tm\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions.pitch_angle_distribution-NTuple{4, Any}","page":"Home","title":"VelocityDistributionFunctions.pitch_angle_distribution","text":"pitch_angle_distribution(vdf, B, Ï†, Î¸; bins=nothing, method=:mean) -> (; data, pitch_angles)\n\nCompute pitch-angle distributions from particle vdf and magnetic field B measurements, given azimuthal Ï† and polar Î¸ angles.\n\nReturns a named tuple with fields:\n\ndata: Pitch-angle distribution array (nbins,) for 2-D input vdf or (nbins, energy) for 3-D input vdf\npitch_angles: Bin center angles in degrees\n\nNotes\n\nvdf can be either 2-D (Ï†, Î¸) or 3-D (Ï†, Î¸, energy)\nbins is used for pitch angle binning. It can be an Integer for uniform bin count, or a Vector of bin edges.\nmethod is used for aggregation. It can be :mean (default) or :sum.\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions.sort_flux_by_pitch_angle!-Tuple{Any, Any}","page":"Home","title":"VelocityDistributionFunctions.sort_flux_by_pitch_angle!","text":"sort_flux_by_pitch_angle(flux, pitch_angle)\n\nSort flux by pitch angle into ascending order. Set sort_on_reverse to true to sort only if the pitch angle is in reverse order.\n\n\n\n\n\n","category":"method"},{"location":"#VelocityDistributionFunctions.tpitch_angle_distribution-NTuple{4, Any}","page":"Home","title":"VelocityDistributionFunctions.tpitch_angle_distribution","text":"tpitch_angle_distribution(vdf, B, Ï†, Î¸; bins=nothing, method=:mean)\n\nCompute pitch-angle distributions ***time series*** from particle vdf and magnetic field B measurements, given azimuthal Ï† and polar Î¸ angles.\n\nReturns a named tuple with fields:\n\ndata: Pitch-angle distribution array, (nbins, time) for 3-D or (nbins, energy, time) for 4-D input vdf\npitch_angles: Bin center angles in degrees\n\nNotes\n\nvdf: can be either 3-D (Ï†, Î¸, time) or 4-D (Ï†, Î¸, energy, time). B should match the time dimension of vdf\nÏ† and Î¸ can be either 1-D (n,) or time-varying 2-D (n, time)\nbins is used for pitch angle binning. It can be an Integer for uniform bin count, or a Vector of bin edges.\nmethod is used for aggregation. It can be :mean (default) or :sum.\n\n\n\n\n\n","category":"method"}]
}
