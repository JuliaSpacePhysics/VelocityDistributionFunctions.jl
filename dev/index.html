<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home ¬∑ VelocityDistributionFunctions.jl</title><meta name="title" content="Home ¬∑ VelocityDistributionFunctions.jl"/><meta property="og:title" content="Home ¬∑ VelocityDistributionFunctions.jl"/><meta property="twitter:title" content="Home ¬∑ VelocityDistributionFunctions.jl"/><meta name="description" content="Documentation for VelocityDistributionFunctions.jl."/><meta property="og:description" content="Documentation for VelocityDistributionFunctions.jl."/><meta property="twitter:description" content="Documentation for VelocityDistributionFunctions.jl."/><meta property="og:url" content="https://JuliaSpacePhysics.github.io/VelocityDistributionFunctions.jl/"/><meta property="twitter:url" content="https://JuliaSpacePhysics.github.io/VelocityDistributionFunctions.jl/"/><link rel="canonical" href="https://JuliaSpacePhysics.github.io/VelocityDistributionFunctions.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>VelocityDistributionFunctions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li><li><a class="tocitem" href="distributions/">Distributions</a></li><li><a class="tocitem" href="kappa/">Kappa</a></li><li><a class="tocitem" href="moment_note/">Math notes for moment calculations</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="VelocityDistributionFunctions"><a class="docs-heading-anchor" href="#VelocityDistributionFunctions">VelocityDistributionFunctions</a><a id="VelocityDistributionFunctions-1"></a><a class="docs-heading-anchor-permalink" href="#VelocityDistributionFunctions" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl">VelocityDistributionFunctions</a>.</p><ul><li><a href="#VelocityDistributionFunctions.AbstractVelocityDistribution"><code>VelocityDistributionFunctions.AbstractVelocityDistribution</code></a></li><li><a href="#VelocityDistributionFunctions.AbstractVelocityPDF"><code>VelocityDistributionFunctions.AbstractVelocityPDF</code></a></li><li><a href="#VelocityDistributionFunctions.BiKappaPDF"><code>VelocityDistributionFunctions.BiKappaPDF</code></a></li><li><a href="#VelocityDistributionFunctions.BiMaxwellianPDF"><code>VelocityDistributionFunctions.BiMaxwellianPDF</code></a></li><li><a href="#VelocityDistributionFunctions.KappaDistribution"><code>VelocityDistributionFunctions.KappaDistribution</code></a></li><li><a href="#VelocityDistributionFunctions.KappaPDF"><code>VelocityDistributionFunctions.KappaPDF</code></a></li><li><a href="#VelocityDistributionFunctions.MaxwellianPDF"><code>VelocityDistributionFunctions.MaxwellianPDF</code></a></li><li><a href="#VelocityDistributionFunctions.ShiftedPDF"><code>VelocityDistributionFunctions.ShiftedPDF</code></a></li><li><a href="#VelocityDistributionFunctions.VelocityDistribution"><code>VelocityDistributionFunctions.VelocityDistribution</code></a></li><li><a href="#Distributions.pdf-Tuple{BiMaxwellianPDF, VPar}"><code>Distributions.pdf</code></a></li><li><a href="#Unitful.ustrip-Tuple{T} where T&lt;:Union{AbstractVelocityPDF, VelocityDistribution}"><code>Unitful.ustrip</code></a></li><li><a href="#VelocityDistributionFunctions.BiKappa-Tuple"><code>VelocityDistributionFunctions.BiKappa</code></a></li><li><a href="#VelocityDistributionFunctions.BiMaxwellian-Tuple"><code>VelocityDistributionFunctions.BiMaxwellian</code></a></li><li><a href="#VelocityDistributionFunctions.Kappa-Tuple"><code>VelocityDistributionFunctions.Kappa</code></a></li><li><a href="#VelocityDistributionFunctions.Maxwellian-Tuple"><code>VelocityDistributionFunctions.Maxwellian</code></a></li><li><a href="#VelocityDistributionFunctions._rand!-Tuple{Random.AbstractRNG, KappaPDF, Any}"><code>VelocityDistributionFunctions._rand!</code></a></li><li><a href="#VelocityDistributionFunctions.compute_field_aligned-NTuple{4, Any}"><code>VelocityDistributionFunctions.compute_field_aligned</code></a></li><li><a href="#VelocityDistributionFunctions.compute_temperature-Union{Tuple{T}, Tuple{StaticArraysCore.SVector{6, T}, Any, Any}} where T"><code>VelocityDistributionFunctions.compute_temperature</code></a></li><li><a href="#VelocityDistributionFunctions.directional_energy_spectra-Tuple{Any, Any, Any}"><code>VelocityDistributionFunctions.directional_energy_spectra</code></a></li><li><a href="#VelocityDistributionFunctions.kappa_thermal_speed-Tuple{Any, Any, Any}"><code>VelocityDistributionFunctions.kappa_thermal_speed</code></a></li><li><a href="#VelocityDistributionFunctions.omega_weights!-NTuple{5, Any}"><code>VelocityDistributionFunctions.omega_weights!</code></a></li><li><a href="#VelocityDistributionFunctions.pitch_angle_distribution-NTuple{4, Any}"><code>VelocityDistributionFunctions.pitch_angle_distribution</code></a></li><li><a href="#VelocityDistributionFunctions.plasma_moments"><code>VelocityDistributionFunctions.plasma_moments</code></a></li><li><a href="#VelocityDistributionFunctions.plasma_moments-Tuple{AbstractVector, Any}"><code>VelocityDistributionFunctions.plasma_moments</code></a></li><li><a href="#VelocityDistributionFunctions.sort_flux_by_pitch_angle!-Tuple{Any, Any}"><code>VelocityDistributionFunctions.sort_flux_by_pitch_angle!</code></a></li><li><a href="#VelocityDistributionFunctions.tpitch_angle_distribution-NTuple{4, Any}"><code>VelocityDistributionFunctions.tpitch_angle_distribution</code></a></li></ul><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.AbstractVelocityDistribution"><a class="docstring-binding" href="#VelocityDistributionFunctions.AbstractVelocityDistribution"><code>VelocityDistributionFunctions.AbstractVelocityDistribution</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>Abstract type for velocity distributions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/types.jl#L10-L12">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.AbstractVelocityPDF"><a class="docstring-binding" href="#VelocityDistributionFunctions.AbstractVelocityPDF"><code>VelocityDistributionFunctions.AbstractVelocityPDF</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>Abstract type for velocity probability distribution functions, extending MultivariateDistribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/types.jl#L1-L3">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.BiKappaPDF"><a class="docstring-binding" href="#VelocityDistributionFunctions.BiKappaPDF"><code>VelocityDistributionFunctions.BiKappaPDF</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">BiKappaPDF(vth_perp, vth_para, Œ∫, b0=[0, 0, 1])
BiKappaPDF(T_perp::Temperature, T_para::Temperature, Œ∫, b0=[0, 0, 1]; mass = me)</code></pre><p>Modified BiKappa velocity distribution with kappa index <code>Œ∫</code>, assuming Œ∫-independent temperatures <span>$T_{‚à•,‚üÇ}$</span>, with magnetic field direction <code>b0</code>. </p><p>The distribution can also be parameterized by kappa thermal speeds <span>$v_{th,‚à•}$</span> and <span>$v_{th,‚üÇ}$</span>.</p><p class="math-container">\[\begin{aligned}
f_Œ∫(ùêØ) &amp; ‚àù \left[1 + \frac{v_‚à•^2}{Œ∫ v_{\mathrm{th}, ‚à•}^2} + \frac{v_‚üÇ^2}{Œ∫ v_{\mathrm{th}, ‚üÇ}^2}\right]^{- Œ∫ - 1} \\
    &amp; = \left[1+\frac{m}{k_B (2 Œ∫-3)} \left(\frac{v_‚à•^2}{T_‚à•}+\frac{v_‚üÇ^2}{T_‚üÇ}\right) \right]^{-Œ∫-1}
\end{aligned}\]</p><p>where the normalization constant is</p><p class="math-container">\[\begin{aligned}
A_Œ∫ &amp;= \left(\frac{1}{œÄ Œ∫}\right)^{3/2} \frac{1}{v_{th,‚à•} v_{th,‚üÇ}^2} \frac{Œì[Œ∫+1]}{Œì[Œ∫-1/2]} \\
  &amp;= \left[\frac{m}{œÄ k_B(2 Œ∫-3)}\right]^{3 / 2} \frac{1}{T_‚üÇ \sqrt{T_‚à•}} \frac{Œì[Œ∫+1]}{Œì[Œ∫-1/2]}
\end{aligned}\]</p><p>See also <a href="#VelocityDistributionFunctions.Kappa-Tuple"><code>Kappa</code></a>, <a href="#VelocityDistributionFunctions.kappa_thermal_speed-Tuple{Any, Any, Any}"><code>kappa_thermal_speed</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/BiKappa.jl#L1-L26">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.BiMaxwellianPDF"><a class="docstring-binding" href="#VelocityDistributionFunctions.BiMaxwellianPDF"><code>VelocityDistributionFunctions.BiMaxwellianPDF</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">BiMaxwellian(vth_perp, vth_para, b0=[0, 0, 1])
BiMaxwellian(T_perp::Temperature, T_para::Temperature, b0=[0, 0, 1]; mass = me)</code></pre><p>BiMaxwellian velocity distribution with different thermal velocities in perpendicular <code>vth_perp</code> and parallel <code>vth_para</code> directions and magnetic field direction <code>b0</code>.</p><p class="math-container">\[f(ùêØ) ‚àù  \exp[-\frac{ùêØ_‚üÇ^2}{v_{\mathrm{th}, ‚üÇ}^2}] \exp[-\frac{ùêØ_‚à•^2}{v_{\mathrm{th}, ‚à•}^2}]\]</p><p>where the normalization constant is <span>$A = ‚àöœÄ^{-3} / (v_{th,‚à•} v_{th,‚üÇ}^2)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/BiMaxwellian.jl#L1-L12">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.KappaDistribution"><a class="docstring-binding" href="#VelocityDistributionFunctions.KappaDistribution"><code>VelocityDistributionFunctions.KappaDistribution</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>A Kappa distribution has a nearly Maxwellian core at low energies, and highenergy tails decreasing as suprathermal power laws that can be significantly broader than exponential tails.</p><p>See also <a href="#pierrardSuprathermalPopulationsTheir2021">Pierrard <em>et al.</em> [1]</a> and <a href="#pierrardKappaDistributionsTheory2010">Pierrard and Lazar [2]</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/Kappa.jl#L1-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.KappaPDF"><a class="docstring-binding" href="#VelocityDistributionFunctions.KappaPDF"><code>VelocityDistributionFunctions.KappaPDF</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">KappaPDF(vth, Œ∫)
KappaPDF(T::Temperature, Œ∫; mass = me)</code></pre><p>Kappa velocity distribution with index <code>Œ∫</code> and thermal velocity <code>vth</code>.</p><p class="math-container">\[f(ùêØ) ‚àù [1 + |ùêØ|¬≤/(Œ∫¬∑v‚Çú‚Çï¬≤)]^{-(Œ∫+1)}\]</p><p>where the normalization constant is <span>$A_3 = Œì(Œ∫ + 1) / Œì(Œ∫ - 1/2) / (œÄ Œ∫ v_{th}^2)^{3/2}$</span>.</p><p><strong>Notes</strong></p><p>Kappa index must be &gt; 1.5 for finite variance. For large Œ∫, the distribution approaches a Maxwellian. Smaller Œ∫ values produce stronger high-energy tails.</p><p>See also <a href="#VelocityDistributionFunctions.kappa_thermal_speed-Tuple{Any, Any, Any}"><code>kappa_thermal_speed</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/Kappa.jl#L8-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.MaxwellianPDF"><a class="docstring-binding" href="#VelocityDistributionFunctions.MaxwellianPDF"><code>VelocityDistributionFunctions.MaxwellianPDF</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Maxwellian(vth)
Maxwellian(T::Temperature; mass = me)</code></pre><p>Isotropic Maxwellian velocity distribution with thermal velocity <code>vth</code> / temperature <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/Maxwellian.jl#L1-L6">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.ShiftedPDF"><a class="docstring-binding" href="#VelocityDistributionFunctions.ShiftedPDF"><code>VelocityDistributionFunctions.ShiftedPDF</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShiftedPDF(base, u0)</code></pre><p>Velocity distribution with a drift velocity <code>u0</code> applied to a <code>base</code> distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/ShiftedPDF.jl#L1-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.VelocityDistribution"><a class="docstring-binding" href="#VelocityDistributionFunctions.VelocityDistribution"><code>VelocityDistributionFunctions.VelocityDistribution</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">VelocityDistribution(n, pdf)</code></pre><p>Physical velocity distribution combining number density <code>n</code> with a velocity probability distribution <code>pdf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/types.jl#L17-L21">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Distributions.pdf-Tuple{BiMaxwellianPDF, VPar}"><a class="docstring-binding" href="#Distributions.pdf-Tuple{BiMaxwellianPDF, VPar}"><code>Distributions.pdf</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>Normalized PDF for the parallel velocity</p><p class="math-container">\[f(v) = 1 / (‚àöœÄ v‚Çú‚Çï) ¬∑ exp[-(v/v‚Çú‚Çï)¬≤]\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/BiMaxwellian.jl#L51-L57">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Unitful.ustrip-Tuple{T} where T&lt;:Union{AbstractVelocityPDF, VelocityDistribution}"><a class="docstring-binding" href="#Unitful.ustrip-Tuple{T} where T&lt;:Union{AbstractVelocityPDF, VelocityDistribution}"><code>Unitful.ustrip</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">ustrip(d::VelocityDistribution)</code></pre><p>Strip units from all fields of a velocity distribution, returning a new distribution with unitless values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/VDFsUnitfulExt.jl#L13-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.BiKappa-Tuple"><a class="docstring-binding" href="#VelocityDistributionFunctions.BiKappa-Tuple"><code>VelocityDistributionFunctions.BiKappa</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">BiKappa(args...; u0=nothing, kw...)
BiKappa(n, args...; u0=nothing, kw...)</code></pre><p>Construct a <a href="#VelocityDistributionFunctions.BiKappaPDF"><code>BiKappaPDF</code></a> velocity distribution.</p><p>If <code>n</code> is provided, returns <a href="#VelocityDistributionFunctions.VelocityDistribution"><code>VelocityDistribution</code></a> with <code>n</code> and the distribution <code>BiKappaPDF(args...; kw...)</code>. If <code>u0</code> is provided, returns <a href="distributions/#ShiftedPDF"><code>ShiftedPDF</code></a> with the distribution <code>BiKappaPDF(args...; kw...)</code> and <code>u0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/Distributions.jl#L41-L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.BiMaxwellian-Tuple"><a class="docstring-binding" href="#VelocityDistributionFunctions.BiMaxwellian-Tuple"><code>VelocityDistributionFunctions.BiMaxwellian</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">BiMaxwellian(args...; u0=nothing, kw...)
BiMaxwellian(n, args...; u0=nothing, kw...)</code></pre><p>Construct a <a href="#VelocityDistributionFunctions.BiMaxwellianPDF"><code>BiMaxwellianPDF</code></a> velocity distribution.</p><p>If <code>n</code> is provided, returns <a href="#VelocityDistributionFunctions.VelocityDistribution"><code>VelocityDistribution</code></a> with <code>n</code> and the distribution <code>BiMaxwellianPDF(args...; kw...)</code>. If <code>u0</code> is provided, returns <a href="distributions/#ShiftedPDF"><code>ShiftedPDF</code></a> with the distribution <code>BiMaxwellianPDF(args...; kw...)</code> and <code>u0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/Distributions.jl#L41-L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.Kappa-Tuple"><a class="docstring-binding" href="#VelocityDistributionFunctions.Kappa-Tuple"><code>VelocityDistributionFunctions.Kappa</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">Kappa(args...; u0=nothing, kw...)
Kappa(n, args...; u0=nothing, kw...)</code></pre><p>Construct a <a href="#VelocityDistributionFunctions.KappaPDF"><code>KappaPDF</code></a> velocity distribution.</p><p>If <code>n</code> is provided, returns <a href="#VelocityDistributionFunctions.VelocityDistribution"><code>VelocityDistribution</code></a> with <code>n</code> and the distribution <code>KappaPDF(args...; kw...)</code>. If <code>u0</code> is provided, returns <a href="distributions/#ShiftedPDF"><code>ShiftedPDF</code></a> with the distribution <code>KappaPDF(args...; kw...)</code> and <code>u0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/Distributions.jl#L41-L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.Maxwellian-Tuple"><a class="docstring-binding" href="#VelocityDistributionFunctions.Maxwellian-Tuple"><code>VelocityDistributionFunctions.Maxwellian</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">Maxwellian(args...; u0=nothing, kw...)
Maxwellian(n, args...; u0=nothing, kw...)</code></pre><p>Construct a <a href="#VelocityDistributionFunctions.MaxwellianPDF"><code>MaxwellianPDF</code></a> velocity distribution.</p><p>If <code>n</code> is provided, returns <a href="#VelocityDistributionFunctions.VelocityDistribution"><code>VelocityDistribution</code></a> with <code>n</code> and the distribution <code>MaxwellianPDF(args...; kw...)</code>. If <code>u0</code> is provided, returns <a href="distributions/#ShiftedPDF"><code>ShiftedPDF</code></a> with the distribution <code>MaxwellianPDF(args...; kw...)</code> and <code>u0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/Distributions.jl#L41-L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions._rand!-Tuple{Random.AbstractRNG, KappaPDF, Any}"><a class="docstring-binding" href="#VelocityDistributionFunctions._rand!-Tuple{Random.AbstractRNG, KappaPDF, Any}"><code>VelocityDistributionFunctions._rand!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">_rand!(rng::AbstractRNG, d::Kappa, x)</code></pre><p>Generates a random velocity vector sampled from the 3D Kappa distribution.</p><p>Algorithm: The Kappa distribution is generated using a compound probability method (decomposition  into a Maxwellian with a Chi-squared distributed temperature variance).</p><ol><li>Sample from Chi-squared: Œæ ~ ChiSq(2Œ∫ - 1)</li><li>Sample from Isotropic Normal: Z ~ Normal(0, I)</li><li><span>$ùêØ = v‚Çú‚Çï * ‚àö(Œ∫ / Œæ) * Z$</span></li></ol><p><strong>References</strong></p><ul><li>https://www.wikiwand.com/en/articles/Student%27s_t-distribution</li><li><a href="https://www.wikiwand.com/en/articles/Multivariate_t-distribution">Multivariate t-distribution</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/Kappa.jl#L66-L82">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.compute_field_aligned-NTuple{4, Any}"><a class="docstring-binding" href="#VelocityDistributionFunctions.compute_field_aligned-NTuple{4, Any}"><code>VelocityDistributionFunctions.compute_field_aligned</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_field_aligned(ttens, t3evec, velocity, magf)</code></pre><p>Field-aligned temperature decomposition and symmetry analysis.</p><p>Rotates the temperature tensor into a field-aligned coordinate system where <span>$\hat{z}&#39; \parallel \mathbf{B}$</span>:</p><p class="math-container">\[\mathbf{T}&#39; = R^{-1}\, \mathbf{T}\, R\]</p><p>The rotation matrix <span>$R$</span> has columns <span>$(\hat{x}&#39;, \hat{y}&#39;, \hat{z}&#39;)$</span> where <span>$\hat{z}&#39; = \hat{B}$</span>, <span>$\hat{y}&#39; = \hat{B} \times \mathbf{V} / |\hat{B} \times \mathbf{V}|$</span>, and <span>$\hat{x}&#39;$</span> completes the right-handed triad.</p><p>The symmetry axis is the eigenvector closest to <span>$\mathbf{B}$</span> (with sign chosen so the dot product is positive), and the symmetry angle is:</p><p class="math-container">\[\alpha = \arccos|\hat{B} \cdot \hat{e}_\parallel|\]</p><p>Returns <code>(; magt3, symm, symm_theta, symm_phi, symm_ang)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/moments/compute.jl#L101-L125">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.compute_temperature-Union{Tuple{T}, Tuple{StaticArraysCore.SVector{6, T}, Any, Any}} where T"><a class="docstring-binding" href="#VelocityDistributionFunctions.compute_temperature-Union{Tuple{T}, Tuple{StaticArraysCore.SVector{6, T}, Any, Any}} where T"><code>VelocityDistributionFunctions.compute_temperature</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_temperature(ptens, density, mass) -&gt; NamedTuple</code></pre><p>Temperature quantities from the pressure tensor.</p><p>Eigenvalue decomposition of <span>$\mathbf{T}$</span> yields three temperature eigenvalues <span>$(T_1, T_2, T_3)$</span> sorted by the SPEDAS heuristic: the eigenvalue whose removal makes the remaining two most similar is assigned to slot 3.</p><p>Returns <code>(; ttens, avgtemp, vthermal, t3, t3evec)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/moments/compute.jl#L73-L84">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.directional_energy_spectra-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#VelocityDistributionFunctions.directional_energy_spectra-Tuple{Any, Any, Any}"><code>VelocityDistributionFunctions.directional_energy_spectra</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">directional_energy_spectra(spec_data, time_var, pitch_angles, loss_cone; para_tol=22.25, anti_tol=22.25)</code></pre><p>Process 3D spectral data (pitch<em>angle √ó energy √ó time) to extract directional flux spectra. This implements the same logic as pyspedas epd</em>l2_Espectra function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/spectra.jl#L21-L26">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.kappa_thermal_speed-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#VelocityDistributionFunctions.kappa_thermal_speed-Tuple{Any, Any, Any}"><code>VelocityDistributionFunctions.kappa_thermal_speed</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">kappa_thermal_speed(T, Œ∫, m)</code></pre><p>Return the most probable speed of a (modified) kappa distribution with Œ∫-Independent temperature <code>T</code>.</p><p class="math-container">\[V_{th} = \sqrt{\frac{Œ∫ - 3/2}{Œ∫} \frac{2 k_B T}{m}}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/distributions/Kappa.jl#L35-L43">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.omega_weights!-NTuple{5, Any}"><a class="docstring-binding" href="#VelocityDistributionFunctions.omega_weights!-NTuple{5, Any}"><code>VelocityDistributionFunctions.omega_weights!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">omega_weights!(omega, theta, phi, dtheta, dphi)</code></pre><p>Compute solid-angle integration weights for moments calculation.</p><p><code>omega</code> should be an array of shape <code>(10, size(theta)...)</code> to store the results. The 10 weight channels are:</p><table><tr><th style="text-align: left">Index</th><th style="text-align: left">Weight</th><th style="text-align: left">Used for</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left"><span>$\int d\Omega$</span></td><td style="text-align: left">density</td></tr><tr><td style="text-align: left">2‚Äì4</td><td style="text-align: left"><span>$\hat{x},\hat{y},\hat{z}$</span> flux</td><td style="text-align: left">particle/energy flux</td></tr><tr><td style="text-align: left">5‚Äì10</td><td style="text-align: left"><span>$xx,yy,zz,xy,xz,yz$</span></td><td style="text-align: left">momentum flux tensor</td></tr></table><p>Follows the IDL/PySPEDAS <code>moments_3d_omega_weights</code> convention (latitude angles).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/moments/omega_weights.jl#L3-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.pitch_angle_distribution-NTuple{4, Any}"><a class="docstring-binding" href="#VelocityDistributionFunctions.pitch_angle_distribution-NTuple{4, Any}"><code>VelocityDistributionFunctions.pitch_angle_distribution</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">pitch_angle_distribution(vdf, B, œÜ, Œ∏; bins=nothing, method=:mean) -&gt; (; data, pitch_angles)</code></pre><p>Compute pitch-angle distributions from particle <code>vdf</code> and magnetic field <code>B</code> measurements, given azimuthal <code>œÜ</code> and polar <code>Œ∏</code> angles.</p><p>Returns a named tuple with fields:</p><ul><li><code>data</code>: Pitch-angle distribution array <code>(nbins,)</code> for 2-D input <code>vdf</code> or <code>(nbins, energy)</code> for 3-D input <code>vdf</code></li><li><code>pitch_angles</code>: Bin center angles in degrees</li></ul><p><strong>Notes</strong></p><ul><li><code>vdf</code> can be either 2-D <code>(œÜ, Œ∏)</code> or 3-D <code>(œÜ, Œ∏, energy)</code></li><li><code>bins</code> is used for pitch angle binning. It can be an <code>Integer</code> for uniform bin count, or a <code>Vector</code> of bin edges.</li><li><code>method</code> is used for aggregation. It can be <code>:mean</code> (default) or <code>:sum</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/pad.jl#L1-L14">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.plasma_moments"><a class="docstring-binding" href="#VelocityDistributionFunctions.plasma_moments"><code>VelocityDistributionFunctions.plasma_moments</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">plasma_moments(dist, sc_pot=0, magf=nothing; mass=dist.mass)</code></pre><p>Compute all plasma moments from a single particle velocity distribution.</p><p><strong>Arguments</strong></p><ul><li><code>dist</code>:   Distribution struct with fields <code>data</code>, <code>energy</code>, <code>theta</code>, <code>dtheta</code>, <code>phi</code>, <code>dphi</code>, <code>bins</code>, <code>mass</code>, <code>charge</code>.</li><li><code>sc_pot</code>:  Spacecraft potential <code>[V]</code>. Positive potential repels ions.</li><li><code>magf</code>:    Magnetic field vector for field-aligned decomposition.           If <code>nothing</code> (default), field-aligned quantities are omitted.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>mass</code>:    Override particle mass. Default: use <code>dist.mass</code>.</li></ul><p><strong>Returns</strong></p><p>A <code>NamedTuple</code> of plasma moments.</p><p><strong>Assumptions</strong></p><p>The input distribution must be a single-time 3D particle velocity distribution on a spherical energy-angle grid with fields:</p><ul><li><code>data</code>:    Distribution values in energy flux units <code>[eV/(cm¬≤¬∑s¬∑sr¬∑eV)]</code></li><li><code>energy</code> and <code>denergy</code>:  Energy bin centers and widths <code>[eV]</code> (<code>denergy</code> is optional; estimated from <code>energy</code> if absent)</li><li><code>theta</code> and <code>dtheta</code>:   Latitude angle bin centers and widths <code>[deg]</code></li><li><code>phi</code> and <code>dphi</code>:     Azimuthal angle bin centers  and widths <code>[deg]</code></li><li><code>bins</code>:    Bin mask (<code>1</code> = valid, <code>0</code> = masked)</li><li><code>mass</code>:    Particle mass <code>[eV/(cm/s)¬≤]</code></li><li><code>charge</code>:  Particle charge <code>[elementary charges, signed]</code></li></ul><p><code>data</code> and <code>bins</code> may be either 2D <code>(n_energy, n_angles)</code> (reformed/flattened) or 3D <code>(n_energy, n_phi, n_theta)</code> (unreformed).</p><p>Energy arrays (<code>energy</code>, <code>denergy</code>) may be supplied as:</p><ul><li>a full array matching the shape of <code>data</code>, when energy bins vary across angles, or</li><li>a 1D vector of length <code>n_energy</code>, when energy bins are the same for every angle.</li></ul><p>Angle arrays (<code>theta</code>, <code>dtheta</code>, <code>phi</code>, <code>dphi</code>) may be supplied as:</p><ul><li>a full array matching the shape of <code>data</code> (energy axis is ignored, first slice is used), or</li><li>an array matching the angle-only dimensions of <code>data</code> (i.e. shape <code>(n_angles,)</code> or <code>(n_phi, n_theta)</code>).</li></ul><p><strong>Angular convention (SPEDAS-compatible)</strong></p><ul><li><code>theta</code>: latitude / elevation angle (‚àí90¬∞ to 90¬∞), <strong>not</strong> colatitude</li><li><code>phi</code>: azimuth (0¬∞ to 360¬∞)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/moments.jl#L36-L78">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.plasma_moments-Tuple{AbstractVector, Any}"><a class="docstring-binding" href="#VelocityDistributionFunctions.plasma_moments-Tuple{AbstractVector, Any}"><code>VelocityDistributionFunctions.plasma_moments</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">plasma_moments(dists::AbstractVector, sc_pots, magfs; mass=nothing)</code></pre><p>Batch-compute plasma moments for multiple distributions, returning a <code>StructArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/moments.jl#L11-L15">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.sort_flux_by_pitch_angle!-Tuple{Any, Any}"><a class="docstring-binding" href="#VelocityDistributionFunctions.sort_flux_by_pitch_angle!-Tuple{Any, Any}"><code>VelocityDistributionFunctions.sort_flux_by_pitch_angle!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">sort_flux_by_pitch_angle(flux, pitch_angle)</code></pre><p>Sort flux by pitch angle into ascending order. Set <code>sort_on_reverse</code> to true to sort only if the pitch angle is in reverse order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/flux.jl#L1-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VelocityDistributionFunctions.tpitch_angle_distribution-NTuple{4, Any}"><a class="docstring-binding" href="#VelocityDistributionFunctions.tpitch_angle_distribution-NTuple{4, Any}"><code>VelocityDistributionFunctions.tpitch_angle_distribution</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">tpitch_angle_distribution(vdf, B, œÜ, Œ∏; bins=nothing, method=:mean)</code></pre><p>Compute pitch-angle distributions ***time series*** from particle <code>vdf</code> and magnetic field <code>B</code> measurements, given azimuthal <code>œÜ</code> and polar <code>Œ∏</code> angles.</p><p>Returns a named tuple with fields:</p><ul><li><code>data</code>: Pitch-angle distribution array, <code>(nbins, time)</code> for 3-D or <code>(nbins, energy, time)</code> for 4-D input <code>vdf</code></li><li><code>pitch_angles</code>: Bin center angles in degrees</li></ul><p><strong>Notes</strong></p><ul><li><code>vdf</code>: can be either 3-D <code>(œÜ, Œ∏, time)</code> or 4-D <code>(œÜ, Œ∏, energy, time)</code>. <code>B</code> should match the time dimension of <code>vdf</code></li><li><code>œÜ</code> and <code>Œ∏</code> can be either 1-D <code>(n,)</code> or time-varying 2-D <code>(n, time)</code></li><li><code>bins</code> is used for pitch angle binning. It can be an <code>Integer</code> for uniform bin count, or a <code>Vector</code> of bin edges.</li><li><code>method</code> is used for aggregation. It can be <code>:mean</code> (default) or <code>:sum</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSpacePhysics/VelocityDistributionFunctions.jl/blob/696d754f035833a6444817c84b018a20595e4fb0/src/pad.jl#L38-L52">source</a></section></details></article><div class="citation canonical"><dl><dt>[1]</dt><dd><div id="pierrardSuprathermalPopulationsTheir2021">V.¬†Pierrard, M.¬†Lazar and M.¬†Maksimovic. <a href="https://doi.org/10.1007/978-3-030-82623-9_2"><em>Suprathermal Populations and Their Effects in Space Plasmas: Kappa vs. Maxwellian</em></a>. In: <em>Kappa Distributions: From Observational Evidences Via Controversial Predictions to a Consistent Theory of Nonequilibrium Plasmas</em>, edited by M.¬†Lazar and H.¬†Fichtner (Springer International Publishing, Cham, 2021); pp.¬†15‚Äì38.</div></dd><dt>[2]</dt><dd><div id="pierrardKappaDistributionsTheory2010">V.¬†Pierrard and M.¬†Lazar. <em>Kappa Distributions: Theory and Applications in Space Plasmas</em>. <a href="https://doi.org/10.1007/s11207-010-9640-2">Solar¬†Physics <strong>267</strong>, 153‚Äì174</a> (2010).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="distributions/">Distributions ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 7 February 2026 06:09">Saturday 7 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
